#!/bin/bash

# PAM configuration SSH:
echo "#PAMAC configuration" >> /etc/pam.d/sshd
echo "auth        required     pam_python.so accesscontrol.py" >> /etc/pam.d/sshd
echo "session     required     pam_python.so accesscontrol.py" >> /etc/pam.d/sshd

# PAM configuration KDM:
echo "#PAMAC configuration" >> /etc/pam.d/kdm
echo "auth        required     pam_python.so accesscontrol.py" >> /etc/pam.d/kdm
echo "session     required     pam_python.so accesscontrol.py" >> /etc/pam.d/kdm

# PAM configuration TTY:
echo "#PAMAC configuration" >> /etc/pam.d/login
echo "auth        required     pam_python.so accesscontrol.py" >> /etc/pam.d/login
echo "session     required     pam_python.so accesscontrol.py" >> /etc/pam.d/login


if [ $(arch) == 'i686' ]
then
	cat /usr/share/goto-accesscontrol/pam_python32.so.base64 |base64 -d >/lib/security/pam_python.so
else
	echo x86_64
fi

